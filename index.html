<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>G.Ark Docs</title>

  <link rel="stylesheet" href="https://unpkg.com/docsify/themes/vue.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8fafc;
      color: #334155;
      line-height: 1.6;
    }

    /* é¡¶éƒ¨å¯¼èˆª */
    .app-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      z-index: 1200;
      background: linear-gradient(135deg,#1e293b 0%,#334155 100%);
      color: #fff;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    .app-nav .left { display:flex; align-items:center; gap:16px; }
    .app-nav .app-name { font-weight:700; font-size:20px; color:#fff; }
    .app-nav a { color:#e2e8f0; text-decoration:none; font-weight:500; }
    .app-nav a:hover { color:#fff; }

    /* æ•´ä½“å®¹å™¨ï¼Œç•™å‡ºé¡¶éƒ¨ç©ºé—´ */
    .docsify-container {
      display: flex;
      min-height: 100vh;
      padding-top: 64px; /* é¡¶éƒ¨å¯¼èˆªé«˜åº¦ */
    }

    /* å·¦ä¾§æ  */
    .sidebar {
      position: fixed;
      left: 0;
      top: 64px;
      width: 280px;
      height: calc(100vh - 64px);
      background: #fff;
      border-right: 1px solid #e2e8f0;
      overflow-y: auto;
      z-index: 900;
      box-shadow: 2px 0 8px rgba(0,0,0,0.04);
    }
    .sidebar-search { padding:20px; border-bottom:1px solid #e2e8f0; background:#fff; }
    .search-title { font-size:14px; font-weight:600; color:#475569; margin-bottom:12px; display:flex; align-items:center; gap:8px; }
    .search-container { position:relative; }
    .search-input {
      width:100%;
      padding:10px 12px 10px 36px;
      border-radius:8px;
      border:1px solid #cbd5e1;
      background:#f8fafc;
      font-size:14px;
    }
    .search-input:focus { outline:none; border-color:#3b82f6; background:#fff; box-shadow:0 0 0 3px rgba(59,130,246,0.08); }
    .search-icon { position:absolute; left:12px; top:50%; transform:translateY(-50%); color:#64748b; }
    .search-hotkey { display:block; font-size:12px; color:#94a3b8; margin-top:6px; }

    /* Docsify ä¾§è¾¹æ æ¸²æŸ“å®¹å™¨çš„æ ·å¼è¡”æ¥ */
    .sidebar .sidebar-nav { padding:16px 12px; }
    .sidebar-nav a { display:block; padding:8px 12px; border-radius:6px; color:#475569; text-decoration:none; font-weight:500; }
    .sidebar-nav a:hover { background:#f1f5f9; color:#1e293b; }

    /* ä¸­é—´ä¸»å†…å®¹ - ä¿®æ”¹ä¸ºä¸¤æ å¸ƒå±€ */
    .main-content {
      flex:1;
      margin: 0 20px 0 280px; /* å·¦ä¾§é¢„ç•™ä¾§æ å®½åº¦ï¼Œå³ä¾§åªæœ‰20pxé—´è· */
      padding: 28px 40px;
      min-height: calc(100vh - 64px);
      background:#fff;
      box-sizing:border-box;
      z-index:1;
      max-width: calc(100% - 300px); /* ç¡®ä¿å†…å®¹ä¸ä¼šå¤ªå®½ */
    }

    /* æœç´¢ç»“æœé¢æ¿ */
    .search-panel {
      position: fixed;
      top: 140px;
      left: 0;
      width: 280px;
      background:#fff;
      border:1px solid #e2e8f0;
      border-radius:8px;
      box-shadow:0 10px 25px rgba(0,0,0,0.1);
      max-height:400px;
      overflow-y:auto;
      z-index:1002;
      display:none;
    }
    .search-panel.active { display:block; }
    .search-result { padding:12px 16px; border-bottom:1px solid #f1f5f9; cursor:pointer; color:#334155; text-decoration:none; display:block; }
    .search-result .title { font-weight:600; margin-bottom:6px; color:#1e293b; }
    .search-result .content { font-size:13px; color:#64748b; }

    /* å“åº”å¼ */
    @media (max-width:1200px) {
      .main-content { margin-right: 20px; }
    }
    @media (max-width:768px) {
      .sidebar { display:none; }
      .main-content { 
        margin-left: 16px; 
        margin-right: 16px; 
        padding:16px;
        max-width: calc(100% - 32px);
      }
      .search-panel { width: calc(100% - 32px); left: 16px; right:16px; }
    }

    /* å°è°ƒæ•´ï¼šä¸è¦å¼ºåˆ¶è¦†ç›– Docsify å†…éƒ¨å¸ƒå±€çš„å¤§èŒƒå›´æ ·å¼ */
    /* ä¿æŒ #app ä¸º Docsify æ ¹å®¹å™¨ */
  </style>
</head>
<body>
  <!-- è‡ªå®šä¹‰é¡¶éƒ¨å¯¼èˆª -->
  <nav class="app-nav" role="navigation" aria-label="Main">
    <div class="left">
      <div class="app-name">G.Ark Docs</div>
      <a href="/">é¦–é¡µ</a>
      <a href="/guide">æŒ‡å—</a>
      <a href="/about">å…³äº</a>
    </div>
    <div class="right">
      <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>
    </div>
  </nav>

  <!-- Docsify æ ¹å®¹å™¨ï¼ˆDocsify å°†åœ¨æ­¤æ¸²æŸ“ sidebar / contentï¼‰ -->
  <div id="app"></div>

  <!-- ä¸¤æ è‡ªå®šä¹‰å¸ƒå±€å®¹å™¨ï¼ˆå»æ‰äº†æ–‡ç« ç›®å½•æ ï¼‰ -->
  <div class="docsify-container" aria-hidden="false">
    <div class="sidebar" aria-label="Sidebar">
      <div class="sidebar-search">
        <div class="search-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          æœç´¢æ–‡æ¡£
        </div>
        <div class="search-container">
          <input id="custom-search-input" class="search-input" placeholder="è¾“å…¥å…³é”®è¯æœç´¢..." />
          <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <span class="search-hotkey">æŒ‰ / é”®å¿«é€Ÿæœç´¢</span>

        <div id="search-panel" class="search-panel">
          <div id="search-results"></div>
        </div>
      </div>

      <!-- Docsify ä¾§è¾¹æ å°†è¢«ç§»åŠ¨åˆ°æ­¤å¤„ -->
      <div data-app-id="sidebar"></div>
    </div>

    <div class="main-content" role="main" aria-live="polite">
      <!-- Docsify ä¸»å†…å®¹å°†è¢«ç§»åŠ¨åˆ°æ­¤å¤„ -->
    </div>
    
    <!-- å»æ‰äº† .article-toc å³ä¾§ç›®å½•æ  -->
  </div>

  <script>
    /***********************
     * è‡ªå®šä¹‰æœç´¢ä¸å¸ƒå±€æ’ä»¶
     ***********************/
    let searchData = [];

    // åˆå§‹åŒ–æœç´¢äº‹ä»¶ç›‘å¬
    function initSearch() {
      // å¿«æ·é”® /
      document.addEventListener('keydown', function(e) {
        if (e.key === '/' && !e.ctrlKey && !e.metaKey) {
          const active = document.activeElement;
          if (active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)) {
            return;
          }
          e.preventDefault();
          const input = document.getElementById('custom-search-input');
          if (input) { input.focus(); input.select && input.select(); }
        }
        if (e.key === 'Escape') {
          closeSearchPanel();
        }
      });

      const input = document.getElementById('custom-search-input');
      if (input) {
        input.addEventListener('input', function(e) {
          performSearch(e.target.value);
        });
        input.addEventListener('focus', function() {
          if (this.value) performSearch(this.value);
        });
      }

      document.addEventListener('click', function(e) {
        if (!e.target.closest('.sidebar-search') && !e.target.closest('.search-panel')) {
          closeSearchPanel();
        }
      });
    }

    function buildSearchIndex() {
      searchData = [];
      // ä»ä¾§è¾¹æ é“¾æ¥æ„å»ºæ–‡æ¡£ç´¢å¼•
      const links = document.querySelectorAll('.sidebar-nav a[href]');
      links.forEach(a => {
        const href = a.getAttribute('href');
        if (!href) return;
        // è¿‡æ»¤é”šç‚¹ä¸å¤–é“¾
        if (href.startsWith('#') || href.startsWith('http')) return;
        searchData.push({
          title: a.textContent.trim(),
          url: href,
          content: ''
        });
      });
    }

    function performSearch(query) {
      if (!query || !query.trim()) { closeSearchPanel(); return; }
      const q = query.toLowerCase();
      const results = [];

      // æ ‡é¢˜åŒ¹é…
      searchData.forEach(d => {
        if (d.title.toLowerCase().includes(q)) {
          results.push({ type: 'document', title: d.title, url: d.url, content: 'æ–‡æ¡£æ ‡é¢˜åŒ¹é…' });
        }
      });

      // å½“å‰é¡µé¢åŒ¹é…ï¼ˆæ ‡é¢˜ä¸æ®µè½ï¼‰
      const content = document.querySelector('.markdown-section');
      if (content) {
        // headings
        const headings = content.querySelectorAll('h1,h2,h3,h4,h5,h6');
        headings.forEach(h => {
          if (h.textContent.toLowerCase().includes(q)) {
            if (!h.id) h.id = 'heading-' + Math.random().toString(36).substr(2,9);
            results.push({ type: 'heading', title: h.textContent, id: h.id, content: 'é¡µé¢æ ‡é¢˜åŒ¹é…' });
          }
        });
        // paragraph snippets (æœ€å¤š3ä¸ª)
        const paragraphs = content.querySelectorAll('p');
        let count = 0;
        paragraphs.forEach(p => {
          if (count >= 3) return;
          const txt = p.textContent || '';
          const idx = txt.toLowerCase().indexOf(q);
          if (idx !== -1) {
            if (!p.id) p.id = 'p-' + Math.random().toString(36).substr(2,9);
            const start = Math.max(0, idx - 30);
            const end = Math.min(txt.length, idx + query.length + 70);
            let excerpt = txt.substring(start,end);
            if (start > 0) excerpt = '...' + excerpt;
            if (end < txt.length) excerpt = excerpt + '...';
            results.push({ type: 'paragraph', title: 'å†…å®¹åŒ¹é…', id: p.id, content: excerpt });
            count++;
          }
        });
      }

      displaySearchResults(results.slice(0,10), query);
    }

    function displaySearchResults(results, query) {
      const panel = document.getElementById('search-panel');
      const container = document.getElementById('search-results');
      if (!panel || !container) return;
      if (!results || results.length === 0) {
        container.innerHTML = `<div class="no-results" style="padding:16px;color:#94a3b8;">æ²¡æœ‰æ‰¾åˆ° "${escapeHtml(query)}" çš„ç›¸å…³ç»“æœ</div>`;
      } else {
        container.innerHTML = results.map(r => {
          if (r.type === 'document') {
            return `<div class="search-result" onclick="navigateToDocument('${escapeAttr(r.url)}')"><div class="title">ğŸ“„ ${escapeHtml(r.title)}</div><div class="content">${escapeHtml(r.content)}</div></div>`;
          } else {
            const icon = r.type === 'heading' ? 'ğŸ”–' : 'ğŸ“';
            return `<div class="search-result" onclick="navigateToSearchResult('${escapeAttr(r.id)}')"><div class="title">${icon} ${escapeHtml(r.title)}</div><div class="content">${escapeHtml(r.content)}</div></div>`;
          }
        }).join('');
      }
      panel.classList.add('active');
    }

    function navigateToDocument(url) {
      closeSearchPanel();
      // ä½¿ç”¨ docsify çš„è·¯ç”±ï¼ˆå¦‚æœè¦åœ¨å•é¡µé¢å†…è·³è½¬ï¼‰
      if (window.$docsify && window.$docsify.router) {
        // fallback to direct location change
        window.location.href = url;
      } else {
        window.location.href = url;
      }
    }

    function navigateToSearchResult(id) {
      closeSearchPanel();
      const el = document.getElementById(id);
      if (el) {
        el.scrollIntoView({ behavior:'smooth', block:'start' });
        // é«˜äº®
        const orig = el.style.backgroundColor;
        el.style.backgroundColor = '#fff3cd';
        setTimeout(() => el.style.backgroundColor = orig || '', 2200);
      }
    }

    function closeSearchPanel() {
      const panel = document.getElementById('search-panel');
      if (panel) panel.classList.remove('active');
    }

    function escapeHtml(str) {
      return String(str).replace(/[&<>"]/g, function(m) {
        return { '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[m];
      });
    }
    function escapeAttr(s) { return String(s).replace(/'/g, "\\'").replace(/"/g,'\\"'); }

    // æš´éœ²ä¸ºå…¨å±€ï¼ˆonclick å†…ä¼šå¼•ç”¨ï¼‰
    window.navigateToDocument = navigateToDocument;
    window.navigateToSearchResult = navigateToSearchResult;

    /***********************
     * Docsify é…ç½®ï¼ˆåœ¨åŠ è½½ docsify è„šæœ¬å‰å®šä¹‰ï¼‰
     ***********************/
    window.$docsify = {
      name: 'G.Ark Docs',
      repo: '',
      loadNavbar: false,   // ä½¿ç”¨è‡ªå®šä¹‰é¡¶éƒ¨å¯¼èˆªï¼Œå› æ­¤ç¦ç”¨ docsify çš„ navbar
      loadSidebar: true,
      subMaxLevel: 3,
      search: null,        // ç¦ç”¨ docsify è‡ªå¸¦æœç´¢ï¼Œä½¿ç”¨è‡ªå®šä¹‰æœç´¢
      plugins: [
        function(hook, vm) {
          // mounted åœ¨ docsify åˆå§‹åŒ–åè§¦å‘ä¸€æ¬¡ï¼ˆå…ƒç´ å­˜åœ¨åï¼‰
          hook.mounted(function() {
            // å°† docsify ç”Ÿæˆçš„ä¾§è¾¹æ ï¼ˆ.sidebar-navï¼‰ç§»åŠ¨åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¾§è¾¹æ å®¹å™¨ï¼ˆdata-app-id="sidebar"ï¼‰
            const originalSidebar = document.querySelector('.sidebar-nav');
            const ourSidebarContainer = document.querySelector('[data-app-id="sidebar"]');
            if (originalSidebar && ourSidebarContainer && !ourSidebarContainer.contains(originalSidebar)) {
              ourSidebarContainer.appendChild(originalSidebar);
            }

            // å°† docsify çš„ contentï¼ˆ.contentï¼‰ç§»åŠ¨åˆ° main-content ä¸­ï¼ˆé¿å…é‡å¤ç§»åŠ¨ï¼‰
            const originalContent = document.querySelector('.content');
            const ourContentContainer = document.querySelector('.main-content');
            if (originalContent && ourContentContainer && !ourContentContainer.contains(originalContent)) {
              ourContentContainer.appendChild(originalContent);
            }

            // åˆå§‹åŒ–æœç´¢ç›‘å¬
            setTimeout(initSearch, 200);
            // æ„å»ºç´¢å¼•ï¼ˆç¨å»¶è¿Ÿï¼Œä¿è¯ sidebar æ¸²æŸ“å®Œæˆï¼‰
            setTimeout(buildSearchIndex, 300);
          });

          // é¡µé¢æ¯æ¬¡æ¸²æŸ“åéƒ½ä¼šæ‰§è¡Œ doneEach
          hook.doneEach(function() {
            // é‡å»ºä¾§è¾¹æ ç´¢å¼•ï¼ˆä¾§è¾¹æ å¯èƒ½åœ¨å¯¼èˆªåˆ‡æ¢åæ›´æ–°ï¼‰
            setTimeout(buildSearchIndex, 100);
          });
        }
      ]
    };
  </script>

  <!-- Docsify ä¸»è„šæœ¬ï¼ˆå¿…é¡»åœ¨ window.$docsify å®šä¹‰ä¹‹åï¼‰ -->
  <script src="https://unpkg.com/docsify/lib/docsify.min.js"></script>

  <!-- å¯é€‰æ’ä»¶ -->
  <script src="//unpkg.com/docsify-copy-code"></script>
  <script src="//unpkg.com/docsify/lib/plugins/zoom-image.js"></script>
  <script src="//unpkg.com/docsify-count/dist/countable.js"></script>
  <script src="//cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/prismjs@1/components/prism-php.min.js"></script>
</body>
</html>